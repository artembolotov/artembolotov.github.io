---
layout: default
---

<div>
  {% include tag-menu.html active_tag="" %}

  <article class="post">
    <h1 class="post-title">{{ page.title }}</h1>
    <time datetime="{{ page.date | date_to_xmlschema }}">
      {% assign m = page.date | date: "%-m" | minus: 1 %}
      {% assign months = "января,февраля,марта,апреля,мая,июня,июля,августа,сентября,октября,ноября,декабря" | split: "," %}
      {{ page.date | date: "%-d" }} {{ months[m] }} {{ page.date | date: "%Y" }}
    </time>

    {% include reading-time.html content=content %}
  </article>
</div>

{{ content | replace: '<hr />', '<div><hr /></div>' }}

<div>
  {% if page.tags %}
  <div class="post-tags">
    {% for post_tag in page.tags %}
      {% include tag-translations.html tag=post_tag %}
      <a href="/blog/{{ post_tag | slugify | downcase }}/" class="tag">#{{ tag_label }}</a>
    {% endfor %}
  </div>
  {% endif %}

  {% include author-footer.html %}
</div>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    const galleries = document.querySelectorAll('.image-gallery');
    console.log('Found galleries:', galleries.length);
    
    // Функция для проверки, видна ли галерея в viewport
    function isGalleryInViewport(gallery) {
      const rect = gallery.getBoundingClientRect();
      const windowHeight = window.innerHeight;
      
      // Галерея считается активной, если она пересекается с viewport
      return rect.bottom > 0 && rect.top < windowHeight;
    }
    
    // Находим активную галерею (видимую в viewport)
    function getActiveGallery() {
      for (const gallery of galleries) {
        if (isGalleryInViewport(gallery)) {
          return gallery.querySelector('.image-gallery-inner');
        }
      }
      return null;
    }
    
    // Глобальный слушатель wheel с passive: false
    document.addEventListener('wheel', function(e) {
      const activeGallery = getActiveGallery();
      
      if (activeGallery) {
        const scrollLeft = activeGallery.scrollLeft;
        const maxScrollLeft = activeGallery.scrollWidth - activeGallery.clientWidth;
        
        console.log('Gallery dimensions:', {
          scrollLeft,
          maxScrollLeft,
          scrollWidth: activeGallery.scrollWidth,
          clientWidth: activeGallery.clientWidth,
          deltaY: e.deltaY
        });
        
        // Если галерея может прокручиваться в нужном направлении
        if ((e.deltaY > 0 && scrollLeft < maxScrollLeft) || 
            (e.deltaY < 0 && scrollLeft > 0)) {
          e.preventDefault();
          
          // Попробуем разные методы прокрутки
          const newScrollLeft = scrollLeft + (e.deltaY * 2);
          
          // Метод 1: Прямое изменение
          activeGallery.scrollLeft = newScrollLeft;
          console.log('Method 1 - Direct:', activeGallery.scrollLeft);
          
          // Метод 2: scrollTo
          activeGallery.scrollTo(newScrollLeft, 0);
          console.log('Method 2 - scrollTo:', activeGallery.scrollLeft);
          
          // Метод 3: scrollBy
          activeGallery.scrollBy(e.deltaY * 2, 0);
          console.log('Method 3 - scrollBy:', activeGallery.scrollLeft);
        }
      }
    }, { passive: false });
  });
</script>