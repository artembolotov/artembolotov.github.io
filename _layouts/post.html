---
layout: default
---

<div>
  {% include tag-menu.html active_tag="" %}

  <article class="post">
    <h1 class="post-title">{{ page.title }}</h1>
    <time datetime="{{ page.date | date_to_xmlschema }}">
      {% assign m = page.date | date: "%-m" | minus: 1 %}
      {% assign months = "января,февраля,марта,апреля,мая,июня,июля,августа,сентября,октября,ноября,декабря" | split: "," %}
      {{ page.date | date: "%-d" }} {{ months[m] }} {{ page.date | date: "%Y" }}
    </time>

    {% include reading-time.html content=content %}
  </article>
</div>

{{ content | replace: '<hr />', '<div><hr /></div>' }}

<div>
  {% if page.tags %}
  <div class="post-tags">
    {% for post_tag in page.tags %}
      {% include tag-translations.html tag=post_tag %}
      <a href="/blog/{{ post_tag | slugify | downcase }}/" class="tag">#{{ tag_label }}</a>
    {% endfor %}
  </div>
  {% endif %}

  {% include author-footer.html %}
</div>

---
layout: default
---

<div>
  {% include tag-menu.html active_tag="" %}

  <article class="post">
    <h1 class="post-title">{{ page.title }}</h1>
    <time datetime="{{ page.date | date_to_xmlschema }}">
      {% assign m = page.date | date: "%-m" | minus: 1 %}
      {% assign months = "января,февраля,марта,апреля,мая,июня,июля,августа,сентября,октября,ноября,декабря" | split: "," %}
      {{ page.date | date: "%-d" }} {{ months[m] }} {{ page.date | date: "%Y" }}
    </time>

    {% include reading-time.html content=content %}
  </article>
</div>

{{ content | replace: '<hr />', '<div><hr /></div>' }}

<div>
  {% if page.tags %}
  <div class="post-tags">
    {% for post_tag in page.tags %}
      {% include tag-translations.html tag=post_tag %}
      <a href="/blog/{{ post_tag | slugify | downcase }}/" class="tag">#{{ tag_label }}</a>
    {% endfor %}
  </div>
  {% endif %}

  {% include author-footer.html %}
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const galleries = document.querySelectorAll('.image-gallery');
  
  function getGalleryUnderCursor(x, y) {
    for (const gallery of galleries) {
      const rect = gallery.getBoundingClientRect();
      if (x >= rect.left && x <= rect.right && y >= rect.top && y <= rect.bottom) {
        return gallery.querySelector('.image-gallery-inner');
      }
    }
    return null;
  }
  
  let isGalleryScrolling = false;
  
  function handleGalleryScroll(e) {
    const activeGallery = getGalleryUnderCursor(e.clientX, e.clientY);
    
    if (activeGallery) {
      const scrollLeft = activeGallery.scrollLeft;
      const maxScrollLeft = activeGallery.scrollWidth - activeGallery.clientWidth;
      
      const canScrollRight = e.deltaY > 0 && scrollLeft < maxScrollLeft;
      const canScrollLeft = e.deltaY < 0 && scrollLeft > 0;
      
      if (canScrollRight || canScrollLeft) {
        // Агрессивная блокировка скролла страницы
        e.preventDefault();
        e.stopPropagation();
        e.stopImmediatePropagation();
        
        isGalleryScrolling = true;
        
        // Временно блокируем скролл body
        document.body.style.overflow = 'hidden';
        
        activeGallery.scrollLeft += e.deltaY;
        
        // Возвращаем скролл body через небольшую задержку
        setTimeout(() => {
          document.body.style.overflow = '';
          isGalleryScrolling = false;
        }, 50);
        
        console.log('Gallery scrolled, page blocked');
        return false; // Дополнительная блокировка
      }
    }
  }
  
  // Слушатель с capture: true (обрабатывается раньше других)
  document.addEventListener('wheel', handleGalleryScroll, { 
    passive: false, 
    capture: true 
  });
  
  // Дополнительный глобальный блокиратор
  document.addEventListener('wheel', function(e) {
    if (isGalleryScrolling) {
      e.preventDefault();
      e.stopPropagation();
      e.stopImmediatePropagation();
      return false;
    }
  }, { passive: false, capture: true });
});
</script>