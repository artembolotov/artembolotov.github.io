---
title: "Роутинг для белых списков"
description: "Делаем сложный интернет проще при использовании VPN"
tags: [notes]
draft: true
---

## Россия, 2026
Все по-разному пользуются интернетом. Для кого-то, это что-то базовое: посидеть в ВК, скинуть квитанцию в чат садика в Максе, посмотреть погоду в яндексе и вызвать там же такси. Бывают и другие сценарии: например, мне нужен youtube, нейронки и доступ к зарубежным исследованиям и статьям. Всё это мало возможно без VPN. Заходя на какой-то сайт, нужно либо включать его, либо выключать (поэтому я вообще перенёс команду на физическую кнопку в телефоне). Обычно он всё же включён и, заходя на тот же кинопоиск или в приложение сбера, для сервиса мы выглядим как гражданин Нидерландов. И в этом есть минусы, поскольку для нас могут убрать какие-то фильмы, а перевод вообще заблокировать. С введением так называемых белых списков, когда не работает ничего кроме сайтов из этого списка (у нас в Костроме этот режим стал постоянным — скорость к ресурсам не из БС режется до 0,2 Мб/с), всё стало ещё неудобнее.

## Решение 1 — роутинг в приложении
На телефоне я пользуюсь [Streisand](https://apps.apple.com/app/id6450534064){:target="_blank"}, куда добавляю свою конфигурацию c VLESS + Reality. Есть и другие вариации (к примеру, [v2RayTune](https://apps.apple.com/app/id6476628951){:target="_blank"} или [v2Box](https://apps.apple.com/app/id6446814690){:target="_blank"}. Суть и них примерно одинаковая, думаю, движок тоже один. Но именно Streisand мне нравился больше (не добавляет периодически дубликаты профилей, стабильнее находит интернет при смене WiFi на сотовые данные).

Приложение позволяет создать свой роутинг из правил, которые будут выполняться по очереди, а если не выполнится ничего, трафик пойдёт по стандартному маршруту (через VPN).

{% capture gallery_streisand_route %}
01.jpg
02.jpg
03.jpg
04.jpg
{% endcapture %}
{% include gallery.html images=gallery_streisand_route %}

Меня устраивала такая реализация, но хотелось продублировать такую настройку на телефонах друзей и родственников. К счастью, здесь предусмотрена такая опция и маршрутом можно поделиться

```xml {: .wrap-text }
streisand://aW1wb3J0L3JvdXRlOi8vWW5Cc2FYTjBNRERWQVFJREJBVUdCd2dKQ2xSdVlXMWxWSFYxYVdSZVpHOXRZV2x1VTNSeVlYUmxaM2xkWkc5dFlXbHVUV0YwWTJobGNsVnlkV3hsYzFKU1ZWOFFKRGRCUXpneE1qSXdMVEZGTmtNdE5EUXlPQzFDT0VFekxVWXhNVFJGTVVZd01qZERNbHBKVUU5dVJHVnRZVzVrVm1oNVluSnBaS01MUUZEVEJBd05DUTQvVm1SdmJXRnBibHR2ZFhSaWIzVnVaRlJoWjY4UU1BOFFFUklURkJVV0Z4Z1pHaHNjSFI0ZklDRWlJeVFsSmljb0tTb3JMQzB1THpBeE1qTTBOVFkzT0RrNk96dzlQbGd5WjJsekxtTnZiVmN5WjJsekxuSjFXVFEzYm1WM2N5NXlkVnRoYkdaaFltRnVheTV5ZFZ4aGRYUm9MVzV6WkdrdWNuVlhZWFYwYnk1eWRWaGhkbWwwYnk1eWRWaGhkbWwwYnk1emRGNWpaRzR0ZEdsdWEyOW1aaTV5ZFZsalpHNHRkbXN1Y25WWVkybHJjbVl1Y25WWFpIcGxiaTV5ZFZ4bmIzTjFjMngxWjJrdWNuVldaMjkyTG5KMVdHZDFMWE4wTG5KMVcybDZZbWx5YTI5dExuSjFYR3RwYm05d2IybHpheTV5ZFZ4c1pXMWhibUZ3Y204dWNuVlpiRzF5ZFM1MFpXTm9WMjFoYVd3dWNuVldiV0Y0TG5KMVdXMXlZV1I0TG01bGRGVnZheTV5ZFZkdmEyTmtiaTV5VjI5dVpXMWxMbkpYYjNwdmJpNXlkVmh2ZW05dVpTNXlkVnR5WlhNdGJuTmthUzV5ZFZseWRYUjFZbVV1Y25WZGNuVjBkV0psYkdsemRDNXlkVlp5ZW1RdWNuVlhjMkpsY2k1eWRWdHpZbVZ5WW1GdWF5NXlkVlYwTWk1eWRWaDBZbUZ1YXk1eWRWdDFjMlZ5WVhCcExtTnZiVjEyYXkxd2IzSjBZV3d1Ym1WMFZuWnJMbU52YlZWMmF5NXlkVloyZEdJdWNuVlZkMkl1Y25WZWQybHNaR0psY25KcFpYTXVjblZWZVdFdWNuVmFlV0Z1WkdWNExtTnZiVnA1WVc1a1pYZ3VibVYwV1hsaGJtUmxlQzV5ZFZ4NVlYTjBZWFJwWXk1dVpYUmFZbVZsYkdsdVpTNXlkVlprYVhKbFkzVFVCQXhCRFFsQ1RrOVNhWENyUTBSRlJrZElTVXBMVEUxYmVXOTFkSFZpWlM1amIyMWJhUzU1ZEdsdFp5NWpiMjFiWjNOMFlYUnBZeTVqYjIxZGVYUXpMbWRuY0doMExtTnZiVjhRRDJkdmIyZHNaWFpwWkdWdkxtTnZiVjhRRldSbGRtVnNiM0JsY25NdVoyOXZaMnhsTG1OdmJWOFFGV2R2YjJkc1pYVnpaWEpqYjI1MFpXNTBMbU52YlY4UUUyTnNhV1Z1ZEhNMkxtZHZiMmRzWlM1amIyMWVaMjl2WjJ4bFlYQnBjeTVqYjIxZkVCSmhZMk52ZFc1MExtZHZiMmRzWlM1amIyMWZFQlJ0ZVdGalkyOTFiblF1WjI5dloyeGxMbU52YmFCVmNISnZlSG5UQkF3TkNWRS9wVkpUVkZWV1dtZHZiMmRzWlM1amIyMVpaMjl2WjJ4bExuSjFXV2R0WVdsc0xtTnZiVnBqYUhKdmJXVXVZMjl0VzJGdVpISnZhV1F1WTI5dEFBZ0FFd0FZQUIwQUxBQTZBRUFBUXdCcUFIVUFmQUNBQUljQWpnQ2FBTTBBMWdEZUFPZ0E5QUVCQVFrQkVnRWJBU29CTkFFOUFVVUJVZ0ZaQVdJQmJnRjdBWWdCa2dHYUFhRUJxd0d4QWJrQndRSEpBZElCM2dIb0FmWUIvUUlGQWhFQ0Z3SWdBaXdDT2dKQkFrY0NUZ0pVQW1NQ2FRSjBBbjhDaVFLV0FxRUNxQUt4QXJRQ3dBTE1BdGdDNUFMeUF3UURIQU0wQTBvRFdRTnVBNFVEaGdPTUE1TURtUU9rQTY0RHVBUERBQUFBQUFBQUFnRUFBQUFBQUFBQVZ3QUFBQUFBQUFBQUFBQUFBQUFBQTg4PQ==
```

Это прекрасно работало, пока список из доменов не вырос. Теперь при попытке импорта приложение просто вылетает, записывая EXC_BAD_ACCESS (Thread stack size exceeded due to excessive recursion) в отчёт Panic. Я писал разработчику, подробно описывал ситуацию, скидывал пример, но он так и не понял, что я от него хочу. Поэтому идём дальше.

## Решение 2 — роутинг в приложении и файл формата geosite